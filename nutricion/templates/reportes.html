{% extends 'base.html' %}
{% load static %}

{% block title %}Reportes Nutricionales{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'nutricion/css/reportes.css' %}">
{% endblock %}

{% block content %}
<div class="reportes-page">
    <h2><i class="fas fa-chart-line"></i> Gráficas y Tablas de Referencia</h2>

    <!-- Selector principal -->
    <div class="selector-seccion">
        <button onclick="mostrarSeccion('ninos')">Niños</button>
        <button onclick="mostrarSeccion('trabajadores')">Trabajadores</button>
    </div>

    <!-- SECCIÓN NIÑOS -->
    <div id="seccion-ninos">
        <h3>1. Peso para la Edad</h3>
        <div class="selector-genero">
            <button onclick="mostrarGenero('nino')">Niños</button>
            <button onclick="mostrarGenero('nina')">Niñas</button>
        </div>

        <div id="grupo-nino">
            <canvas id="graficoPesoEdadNino"></canvas>
            <table border="1">
                <thead><tr><th>Edad (meses)</th><th>P3</th><th>P15</th><th>P50</th><th>P85</th><th>P97</th></tr></thead>
                <tbody>
                    <tr><td>0</td><td>2.1</td><td>2.5</td><td>3.3</td><td>4.1</td><td>4.6</td></tr>
                    <tr><td>1</td><td>3.0</td><td>3.4</td><td>4.2</td><td>5.1</td><td>5.5</td></tr>
                    <tr><td>2</td><td>3.8</td><td>4.2</td><td>5.0</td><td>6.0</td><td>6.3</td></tr>
                </tbody>
            </table>
        </div>

        <div id="grupo-nina" style="display: none;">
            <canvas id="graficoPesoEdadNina"></canvas>
            <table border="1">
                <thead><tr><th>Edad (meses)</th><th>P3</th><th>P15</th><th>P50</th><th>P85</th><th>P97</th></tr></thead>
                <tbody>
                    <tr><td>0</td><td>2.0</td><td>2.4</td><td>3.2</td><td>4.0</td><td>4.5</td></tr>
                    <tr><td>1</td><td>2.9</td><td>3.3</td><td>4.1</td><td>5.0</td><td>5.4</td></tr>
                    <tr><td>2</td><td>3.7</td><td>4.1</td><td>4.9</td><td>5.9</td><td>6.2</td></tr>
                </tbody>
            </table>
        </div>

        <h3>2. Talla para la Edad</h3>
        <div class="selector-genero">
            <button onclick="mostrarGeneroTalla('nino')">Niños</button>
            <button onclick="mostrarGeneroTalla('nina')">Niñas</button>
        </div>

        <div id="grupo-talla-nino">
            <canvas id="graficoTallaEdadNino"></canvas>
            <table border="1">
                <thead><tr><th>Edad (meses)</th><th>P3</th><th>P15</th><th>P50</th><th>P85</th><th>P97</th></tr></thead>
                <tbody>
                    <tr><td>0</td><td>46.3</td><td>48.0</td><td>49.9</td><td>51.8</td><td>53.4</td></tr>
                    <tr><td>1</td><td>50.8</td><td>52.5</td><td>54.7</td><td>56.7</td><td>58.4</td></tr>
                    <tr><td>2</td><td>54.4</td><td>56.2</td><td>58.4</td><td>60.5</td><td>62.3</td></tr>
                </tbody>
            </table>
        </div>

        <div id="grupo-talla-nina" style="display: none;">
            <canvas id="graficoTallaEdadNina"></canvas>
            <table border="1">
                <thead><tr><th>Edad (meses)</th><th>P3</th><th>P15</th><th>P50</th><th>P85</th><th>P97</th></tr></thead>
                <tbody>
                    <tr><td>0</td><td>45.6</td><td>47.3</td><td>49.1</td><td>51.0</td><td>52.7</td></tr>
                    <tr><td>1</td><td>50.0</td><td>51.7</td><td>53.7</td><td>55.6</td><td>57.4</td></tr>
                    <tr><td>2</td><td>53.4</td><td>55.1</td><td>57.1</td><td>59.2</td><td>61.0</td></tr>
                </tbody>
            </table>
        </div>

        <h3>3. Peso para la Talla</h3>
        <div class="selector-genero">
            <button onclick="mostrarGeneroPesoTalla('nino')">Niños</button>
            <button onclick="mostrarGeneroPesoTalla('nina')">Niñas</button>
        </div>

        <div id="grupo-peso-talla-nino">
            <canvas id="graficoPesoTallaNino"></canvas>
            <table border="1">
                <thead><tr><th>Talla (cm)</th><th>P3</th><th>P15</th><th>P50</th><th>P85</th><th>P97</th></tr></thead>
                <tbody>
                    <tr><td>65</td><td>6.2</td><td>6.7</td><td>7.3</td><td>7.9</td><td>8.5</td></tr>
                    <tr><td>70</td><td>7.1</td><td>7.7</td><td>8.3</td><td>9.0</td><td>9.7</td></tr>
                    <tr><td>75</td><td>7.8</td><td>8.5</td><td>9.2</td><td>10.0</td><td>10.8</td></tr>
                </tbody>
            </table>
        </div>

        <div id="grupo-peso-talla-nina" style="display: none;">
            <canvas id="graficoPesoTallaNina"></canvas>
            <table border="1">
                <thead><tr><th>Talla (cm)</th><th>P3</th><th>P15</th><th>P50</th><th>P85</th><th>P97</th></tr></thead>
                <tbody>
                    <tr><td>65</td><td>6.0</td><td>6.5</td><td>7.1</td><td>7.8</td><td>8.4</td></tr>
                    <tr><td>70</td><td>6.9</td><td>7.5</td><td>8.1</td><td>8.9</td><td>9.6</td></tr>
                    <tr><td>75</td><td>7.7</td><td>8.3</td><td>9.0</td><td>9.9</td><td>10.7</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- SECCIÓN TRABAJADORES -->
    <div id="seccion-trabajadores" style="display: none;">
        <h3>IMC - Clasificación de Trabajadores</h3>
        <canvas id="graficoIMCTrabajadores"></canvas>
        <table border="1">
            <thead><tr><th>Nombre</th><th>IMC</th><th>Clasificación</th></tr></thead>
            <tbody>
                <tr><td>Ana</td><td>17.5</td><td>Bajo peso</td></tr>
                <tr><td>Luis</td><td>23.4</td><td>Normal</td></tr>
                <tr><td>Pedro</td><td>28.0</td><td>Sobrepeso</td></tr>
                <tr><td>Laura</td><td>31.2</td><td>Obesidad I</td></tr>
                <tr><td>Carlos</td><td>42.1</td><td>Obesidad III</td></tr>
            </tbody>
        </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Secciones generales
function mostrarSeccion(seccion) {
    document.getElementById('seccion-ninos').style.display = seccion === 'ninos' ? 'block' : 'none';
    document.getElementById('seccion-trabajadores').style.display = seccion === 'trabajadores' ? 'block' : 'none';
}

// Sub-secciones por género
function mostrarGenero(g) {
    document.getElementById('grupo-nino').style.display = g === 'nino' ? 'block' : 'none';
    document.getElementById('grupo-nina').style.display = g === 'nina' ? 'block' : 'none';
}
function mostrarGeneroTalla(g) {
    document.getElementById('grupo-talla-nino').style.display = g === 'nino' ? 'block' : 'none';
    document.getElementById('grupo-talla-nina').style.display = g === 'nina' ? 'block' : 'none';
}
function mostrarGeneroPesoTalla(g) {
    document.getElementById('grupo-peso-talla-nino').style.display = g === 'nino' ? 'block' : 'none';
    document.getElementById('grupo-peso-talla-nina').style.display = g === 'nina' ? 'block' : 'none';
}

// Gráficos (puedes separar cada uno en su bloque si prefieres)
new Chart(graficoPesoEdadNino, {type:'line',data:{labels:['0','1','2'],datasets:[{label:'P3',data:[2.1,3.0,3.8],borderColor:'red',fill:false},{label:'P50',data:[3.3,4.2,5.0],borderColor:'green',fill:false},{label:'P97',data:[4.6,5.5,6.3],borderColor:'blue',fill:false}]}});
new Chart(graficoPesoEdadNina, {type:'line',data:{labels:['0','1','2'],datasets:[{label:'P3',data:[2.0,2.9,3.7],borderColor:'red',fill:false},{label:'P50',data:[3.2,4.1,4.9],borderColor:'green',fill:false},{label:'P97',data:[4.5,5.4,6.2],borderColor:'blue',fill:false}]}});
new Chart(graficoTallaEdadNino, {type:'line',data:{labels:['0','1','2'],datasets:[{label:'P3',data:[46.3,50.8,54.4],borderColor:'red',fill:false},{label:'P50',data:[49.9,54.7,58.4],borderColor:'green',fill:false},{label:'P97',data:[53.4,58.4,62.3],borderColor:'blue',fill:false}]}});
new Chart(graficoTallaEdadNina, {type:'line',data:{labels:['0','1','2'],datasets:[{label:'P3',data:[45.6,50.0,53.4],borderColor:'red',fill:false},{label:'P50',data:[49.1,53.7,57.1],borderColor:'green',fill:false},{label:'P97',data:[52.7,57.4,61.0],borderColor:'blue',fill:false}]}});
new Chart(graficoPesoTallaNino, {type:'line',data:{labels:['65','70','75'],datasets:[{label:'P3',data:[6.2,7.1,7.8],borderColor:'red',fill:false},{label:'P50',data:[7.3,8.3,9.2],borderColor:'green',fill:false},{label:'P97',data:[8.5,9.7,10.8],borderColor:'blue',fill:false}]}});
new Chart(graficoPesoTallaNina, {type:'line',data:{labels:['65','70','75'],datasets:[{label:'P3',data:[6.0,6.9,7.7],borderColor:'red',fill:false},{label:'P50',data:[7.1,8.1,9.0],borderColor:'green',fill:false},{label:'P97',data:[8.4,9.6,10.7],borderColor:'blue',fill:false}]}});
new Chart(graficoIMCTrabajadores, {type:'bar',data:{labels:['Ana','Luis','Pedro','Laura','Carlos'],datasets:[{label:'IMC',data:[17.5,23.4,28.0,31.2,42.1],backgroundColor:['orange','green','yellow','red','purple']}]}});
</script>
{% endblock %}